<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Html5 Upload Image</title>
<link rel="stylesheet" type="text/css" href="css/main.css" />
<script type="text/javascript" src="js/_jquery-2.0.3.min.js"></script>
<script type="text/javascript" src="js/imageUtility.js"></script>
<script type="text/javascript" src="js/html5Upload.js"></script>
</head>
<body style="background-color:antiquewhite">
<style>
p a {
	text-decoration: none;
	color: rgb(155, 93, 52);
}
.textbox {
	background-color: white;
	border: 1px solid;
	width: 50%;
}
.subtitle {
	width: 480px;
	font-size: 18px;
	border-bottom: 1px solid; border-top: 1px solid;
}
</style>
<script type="text/javascript">
$(function(){
	var imageUtilityObj = {
		'imgSize': {
			'0': {'spec': 'SQR', 'W': 55, 'H': 55},
			'1': {'spec': 'SQR', 'W': 200, 'H': 200},
			'2': {'spec': 'MAX', 'W': 400, 'H': null},
			'3': {'spec': 'MAX', 'W': 700, 'H': 700},
			'4': {'spec': 'MAX', 'W': 1400, 'H': 1400}
		},
		'thumbnail': {
			'width': 120, 'height': 120
		},
		'thumbEvent': function(thumbnail){ $("#uploadInfo").append(thumbnail) }
	};
	var options = {
		uploadArea: '#uploadArea', uploadButton: '#uploadButton', uploadAbort: '#uploadAbort',	//upload element
		mimeTypes: html5.paras('imageMime'), mimeStrict: false,	//mimeTypes setting
		numLimit: 100, numLimitTotal: 0,	//number setting
		sizeLimitUni: 10485760, sizeLimitSet: 0, sizeLimitTotal: 0,	//size setting
		dragenter: function(e){$(this).css("background-color", "rgb(240, 207, 141)")},	//DnD event setting
		dragover: function(e){},	//DnD event setting
		dragleave: function(e){$(this).css("background-color", "#DDD")},	//DnD event setting
		dropdown: function(e){$(this).css("background-color", "#DDD")},	//DnD event setting
		readMethod: 'readAsDataURL',	//FileReader method setting
		startReader: function(e, file){ if($("#myProgress").size()) $("#myProgress").show(); },	//startReader
		progressReader: function(e, file){ if(e.lengthComputable) return Math.round((e.loaded/e.total) * 100); },	//progressReader
		loadReader: function(e, file){ imageUtility.readProcess(e, file, imageUtilityObj); },	//loadReader
		endReader: function(e, file){
			if(e.target.error) console.error(e.target.error.name);
			file = e = undefined; if(typeof(CollectGarbage) == "function") CollectGarbage();
		},	//endReader
		abortReader: function(e, file){ console.warn('Aborting'); if($("#myProgress").size()) $("#myProgress").hide(); }, //abortReader
		ajaxType: 'POST', ajaxURL: 'imageMaker.php', ajaxCache: true, ajaxData: 'ajaxData',	//Ajax request setting
		startXHR: function(e, file){},	//startXHR
		progressXHR: function(e, file){ if(e.lengthComputable) return Math.round((e.loaded/e.total) * 100); },	//progressXHR
		loadXHR: function(e, file){
			var progress = html5.progress(file), myProgress = document.getElementById('myProgress'),
				optProgress = JSON.parse(myProgress.getAttribute('data-progress')),
				optText = JSON.parse(myProgress.getAttribute('data-text')),
				optValue = JSON.parse(myProgress.getAttribute('data-value')),
				progTxt = +(optText.show) ? optText.content[0] + html5.paras('object')['counter']
							+optText.content[1] + html5.paras('totalNumber') + optText.content[2] : '',
				progVal = (Math.round(progress*10)/10)*100 + optValue.sign;
			if(optValue.pos != 'none') progTxt = (optValue.pos == 'right') ? progTxt+' '+progVal : progVal+' '+progTxt;
			myProgress.getContext('2d').clearRect(0, 0, myProgress.width, myProgress.height);
			myProgress.getContext('2d').fillStyle = optProgress.barRGB;
			myProgress.getContext('2d').fillRect(0, 0, progress*myProgress.width, myProgress.height);
			myProgress.getContext('2d').fillStyle = optProgress.txtRGB;
			myProgress.getContext('2d').fillText(progTxt, optText.x, optText.y, myProgress.width);
		},	//loadXHR
		endXHR: function(e, file){
			if(e.target.error) console.error(e.target.error.name);
			file = e = undefined; if(typeof(CollectGarbage) == "function") CollectGarbage();
		},	//endXHR
		errorXHR: function(e, file){}	//errorXHR
	};
	html5.upload(options);
});
function imageClick() {
	$("#uploadButton").trigger("click");
}
</script>

<section id="demo">		<!--section demo-->
<h1>Demo</h1>
<!--drag and drop area-->
<div id="uploadArea"></div>
<!--upload progressing bar-->
<div class="myProgress"><canvas id="myProgress" width="500px" height="20px" 
	data-progress='{"barRGB": "rgba(255, 215, 0, 0.4)", "txtRGB": "#444"}'
	data-text='{"show": true, "content": ["No: ", " file Total: ", " file"], "x": "50", "y": "16"}'
	data-value='{"pos": "right", "value": "100", "sign": "%"}'>
</canvas></div>
<!--upload information-->
<div id="uploadInfo" class="uploadInfo"></div>
<!--upload select button-->
<div class="uploadButton">
	<a href="javascript:void(0)" onClick="imageClick();">UPLOAD</a>
	<input type="file" id="uploadButton" style="display:none" multiple />
</div>
<!--upload abort button-->
<div class="uploadAbort"><a id="uploadAbort" href="javascript:void(0)">ABORT</a></div>
</section><hr>

<section id="start">	<!--section start-->
<h1>Getting Started</h1>
<div class="textbox">
	<p>//Setting the<b>upload options</b></p>
	<p><b>var options = { ... }</b></p><br>
	<p>//Setting the<b>imageUtility options( sample in this case )</b></p>
	<p><b>var imageUtilityObj = { ... }</b></p><br>
	<p>//Assign the parameter and event setting to options then starting the plugin by<b>self-invoking</b></p>
	<p><b>html5.upload(options)</b></p><br>
</div>
<p>This is a upload plugin based on<b>html5 fileAPI( FileReader )</b>, it support any MIME types of file upload and event customized.</p>
<p>Design your own script to complete specify upload task in html5Upload plugin.</p>
<p><b>( Please execute the plugin in your server, may IE will be slow than other browser. )</b></p>
<!--html5Upload public function-->
<br><p class="subtitle"><b>Public function in html5Upload</b></p>
<div class="textbox"><p><b>paras : function(parameter){ return eval(parameter) }</b> &nbsp; //get the constant or variable in upload processing</p></div>
<div class="textbox"><p><b>setParas : function(obj){ object = jQuery.extend(true, object, obj) }</b> &nbsp; //set the constant or variable in protect object</p></div>
<div class="textbox"><p><b>progress : function(file){ return uploadProgress(file) }</b> &nbsp; //get the value of quantify in upload processing</p></div>
<div class="textbox"><p><b>upload : function(options){ initial(options) }</b> &nbsp; //using the html5Upload plugin</p></div>
<div class="textbox"><p><b>ajaxTxing : function(ajaxData, file){ ajaxTxing(ajaxData, file) }</b> &nbsp; //transfer the file to server by ajax</p></div>
<!--imageUtility parameter setting-->
<br><p class="subtitle"><b>ImageUtility Parameter Setting( sample case )</b></p>
<div class="textbox"><p><b>imgSize</b> &nbsp; //object of image scaling size <b>Default: Default scaling Object</b></p></div>
<p>( setting the object of scaling size to upload image. )</p><br>
<div class="textbox"><p><b>thumbnail</b> &nbsp; //object of thumbnail size <b>Default: Default thumbnail Object</b></p></div>
<p>( setting the object of thumbnail. )</p><br>
<div class="textbox"><p><b>thumbEvent</b> &nbsp; //event of upload thumbnail <b>Default: function(thumbnail){ }</b></p></div>
<p>( setting the event to upload thumbnail. )</p><br>
<!--imageUtility public function-->
<br><p class="subtitle"><b>Public function in imageUtility( sample script )</b></p>
<div class="textbox"><p><b>imgResizeMAX : function(MAX_WIDTH, MAX_HEIGHT, width, height)</b> &nbsp; //scaling image in maximum size</p></div>
<div class="textbox"><p><b>imgResizeMIN : function(MIN_WIDTH, MIN_HEIGHT, width, height)</b> &nbsp; //scaling image in minimum size</p></div>
<div class="textbox"><p><b>dataURL2Blob : function(dataURL, dataTYPE)</b> &nbsp; //convert the dataURL to blob url</p></div>
<div class="textbox"><p><b>cutSquare : function(canvas, width, height)</b> &nbsp; //squared image cutter</p></div>
<div class="textbox"><p><b>canvas2JPEG : function(image, scale, mode)</b> &nbsp; //convert the canvas to JPEG image</p></div>
<div class="textbox"><p><b>thumbnail : function(image, object)</b> &nbsp; //thumbnail of upload image</p></div>
<div class="textbox"><p><b>canvasWorker : function(image, file, thumbnail, imgSize, sBuffer)</b> &nbsp; //using web worker to process image in background of client side</p></div>
<div class="textbox"><p><b>canvasNoWorker : function(image, file, thumbnail, imgSize)</b> &nbsp; //to process image in client side of single thread</p></div>
<div class="textbox"><p><b>readProcess : function(e, file, object)</b> &nbsp; //fileAPI reader processor</p></div>
</section><hr>

<section id="document">	<!--section document-->
<h1>Document</h1>
<!--Upload Parameter Setting-->
<p class="subtitle"><b>Parameter Setting</b></p>
<div class="textbox"><p><b>uploadArea</b> &nbsp; //element of upload area <b>Default: #uploadArea</b></p></div>
<p>( setting the element name to upload area. )</p><br>
<div class="textbox"><p><b>uploadButton</b> &nbsp; //element of upload button <b>Default: #uploadButton</b></p></div>
<p>( setting the element name to upload button. )</p><br>
<div class="textbox"><p><b>uploadAbort</b> &nbsp; //element of upload abort <b>Default: #uploadAbort</b></p></div>
<p>( setting the element name to upload abort. )</p><br>
<div class="textbox"><p><b>mimeTypes</b> &nbsp; //upload mime types <b>Default: imageMime</b></p></div>
<p>( select the mime types pattern or input mime types array directly. )</p>
<p>( offer the imageMime, audioMime, videoMime, textMime types. )</p><br>
<div class="textbox"><p><b>mimeStrict</b> &nbsp; //strict mime types <b>Default: true</b></p></div>
<p>( can upload or not in the uncatch mime types situation. )</p><br>
<div class="textbox"><p><b>numLimit</b> &nbsp; //number limit of each upload <b>Default: 100</b></p></div>
<p>( until exceeded limit, 0 is infinite number. )</p><br>
<div class="textbox"><p><b>numLimitTotal</b> &nbsp; //total number limit of upload <b>Default: 0</b></p></div>
<p>( until exceeded limit, 0 is infinite number. )</p><br>
<div class="textbox"><p><b>sizeLimitUni</b> &nbsp; //limit the unit file size <b>Default: 0</b></p></div>
<p>( cancel the single upload request when a file size exceeded limit, 0 is infinite size. )</p><br>
<div class="textbox"><p><b>sizeLimitSet</b> &nbsp; //limit a set of upload file size <b>Default: 0</b></p></div>
<p>( cancel the upload request when a set of file size exceeded limit, 0 is infinite size. )</p><br>
<div class="textbox"><p><b>sizeLimitTotal</b> &nbsp; //limit the total uploaded size <b>Default: 0</b></p></div>
<p>( cancel the upload request when total file size exceeded limit, 0 is infinite size. )</p><br>
<div class="textbox"><p><b>readMethod</b> &nbsp; //setting the fileAPI reader method <b>Default: readAsDataURL</b></p></div>
<p>( including readAsText, readAsDataURL, readAsArrayBuffer, readAsBinaryString. )</p><br>
<div class="textbox"><p><b>ajaxType</b> &nbsp; //setting the ajax request type <b>Default: POST</b></p></div>
<p>( HTTP request methods including get and post. )</p><br>
<div class="textbox"><p><b>ajaxURL</b> &nbsp; //setting the ajax request url <b>Default: ' '</b></p></div>
<p>( HTTP request server address. )</p><br>
<div class="textbox"><p><b>ajaxCache</b> &nbsp; //setting the ajax request cache <b>Default: true</b></p></div>
<p>( HTTP request ajax cache switch. )</p><br>
<div class="textbox"><p><b>ajaxData</b> &nbsp; //setting the data object key of ajax request <b>Default: ajaxData</b></p></div>
<p>( HTTP request ajax data object key. )</p><br>
<!--Upload Event Setting-->
<br><p class="subtitle"><b>Event Setting</b></p>
<div class="textbox"><p><b>dragenter: function(e){}</b> &nbsp; //action of upload dragenter <b>Default: {}</b></p></div>
<div class="textbox"><p><b>dragover: function(e){}</b> &nbsp; //action of upload dragover <b>Default: {}</b></p></div>
<div class="textbox"><p><b>dragleave: function(e){}</b> &nbsp; //action of upload dragleave <b>Default: {}</b></p></div>
<div class="textbox"><p><b>dropdown: function(e){}</b> &nbsp; //action of upload dropdown <b>Default: {}</b></p></div>
<div class="textbox"><p><b>startReader: function(e, file){}</b> &nbsp; //setting the fileAPI start event <b>Default: {}</b></p></div>
<div class="textbox"><p><b>progressReader: function(e, file){}</b> &nbsp; //setting the fileAPI progress event <b>Default: {}</b></p></div>
<div class="textbox"><p><b>loadReader: function(e, file){}</b> &nbsp; //setting the fileAPI load event <b>Default: {}</b></p></div>
<div class="textbox"><p><b>endReader: function(e, file){}</b> &nbsp; //setting the fileAPI end event <b>Default: {}</b></p></div>
<div class="textbox"><p><b>abortReader: function(e, file){}</b> &nbsp; //setting the fileAPI abort event <b>Default: {}</b></p></div>
<div class="textbox"><p><b>startXHR: function(e, file){}</b> &nbsp; //setting the ajaxXHR start event <b>Default: {}</b></p></div>
<div class="textbox"><p><b>progressXHR: function(e, file){}</b> &nbsp; //setting the ajaxXHR progress event <b>Default: {}</b></p></div>
<div class="textbox"><p><b>loadXHR: function(e, file){}</b> &nbsp; //setting the ajaxXHR load event <b>Default: {}</b></p></div>
<div class="textbox"><p><b>endXHR: function(e, file){}</b> &nbsp; //setting the ajaxXHR end event <b>Default: {}</b></p></div>
<div class="textbox"><p><b>errorXHR: function(e, file){}</b> &nbsp; //setting the ajaxXHR error event <b>Default: {}</b></p></div>
</section><hr>

<section id="contact">	<!--section contact-->
<h1>Contact</h1>
<p class="subtitle"><b>html5Upload.js was produced by Shawn Wu in 20140222</b></p>
<p>@<b>Wu Shang En</b> on <a href="https://www.facebook.com/shangen.wu">Facebook</a> 
or <a href="https://twitter.com/WuShangEn">Twitter</a></p>
<p style="text-decoration:none;">@This project under the <a href="_mitLicense.html">MIT License</a></p>
<p style="text-decoration:none;">@Fork me on <a href="https://github.com/xenophon566/jquery.dOb">Github</a></p><br><br>
</section><hr>
</body>
</html>
